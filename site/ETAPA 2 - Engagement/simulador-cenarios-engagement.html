<!DOCTYPE html>
<html lang="pt-pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulador de Cen√°rios de Engagement ‚Äî ETAPA 2</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .card { background: #fff; border: 1px solid #e5e7eb; border-radius: 1rem; box-shadow: 0 4px 18px rgba(2,6,23,.06); }
        .scenario-card { transition: all 0.3s ease; cursor: pointer; }
        .scenario-card:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(2,6,23,.1); }
        .choice-btn { transition: all 0.2s ease; }
        .choice-btn:hover { transform: scale(1.02); }
        .correct { background: #d4edda; border-color: #c3e6cb; color: #155724; }
        .incorrect { background: #f8d7da; border-color: #f5c6cb; color: #721c24; }
        .partial { background: #fff3cd; border-color: #ffeaa7; color: #856404; }
        .progress-bar { transition: width 0.5s ease; }
        .hint { font-size: .9rem; color: #475569; }
        .score-badge { animation: pulse 2s infinite; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.8; } }
    </style>
</head>
<body class="bg-gray-50 p-6">
    <div class="max-w-6xl mx-auto">
        <!-- Navega√ß√£o -->
        <nav class="mb-6">
            <a href="../etapa-02-engagement/" class="inline-flex items-center text-blue-600 hover:text-blue-800 transition-colors">
                <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
                </svg>
                Voltar ao √çndice da ETAPA 2 ‚Äî Engagement
            </a>
        </nav>

        <h1 class="text-3xl font-bold text-gray-900 mb-6">üé≠ Simulador de Cen√°rios de Engagement</h1>
        <p class="text-gray-600 mb-8">Pratique estrat√©gias de engagement enfrentando situa√ß√µes reais de resist√™ncia em projetos de Data Governance. Cada escolha afeta o seu sucesso!</p>

        <!-- Dashboard de Progresso -->
        <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-8">
            <div class="card p-4 text-center">
                <div class="text-2xl font-bold text-blue-600" id="scenarioCounter">0/12</div>
                <div class="text-sm text-gray-600">Cen√°rios Completados</div>
            </div>
            <div class="card p-4 text-center">
                <div class="text-2xl font-bold text-green-600" id="scoreDisplay">0</div>
                <div class="text-sm text-gray-600">Pontua√ß√£o Total</div>
            </div>
            <div class="card p-4 text-center">
                <div class="text-2xl font-bold text-purple-600" id="levelDisplay">Iniciante</div>
                <div class="text-sm text-gray-600">N√≠vel Atual</div>
            </div>
            <div class="card p-4 text-center">
                <div class="text-2xl font-bold text-orange-600" id="streakDisplay">0</div>
                <div class="text-sm text-gray-600">Sequ√™ncia Correta</div>
            </div>
        </div>

        <!-- Barra de Progresso -->
        <div class="card p-4 mb-8">
            <div class="flex justify-between items-center mb-2">
                <span class="text-sm text-gray-600">Progresso Geral</span>
                <span class="text-sm text-gray-600" id="progressText">0%</span>
            </div>
            <div class="w-full bg-gray-200 rounded-full h-3">
                <div class="progress-bar bg-blue-600 h-3 rounded-full" style="width: 0%" id="progressBar"></div>
            </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <!-- Coluna Esquerda: Cen√°rio Atual -->
            <div class="lg:col-span-2 space-y-6">
                <div class="card p-6" id="scenarioCard">
                    <div class="flex items-center mb-4">
                        <span class="bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm font-medium" id="scenarioType">Selecione um cen√°rio</span>
                        <span class="ml-auto text-sm text-gray-500" id="scenarioDifficulty"></span>
                    </div>
                    
                    <h3 class="text-xl font-semibold mb-4" id="scenarioTitle">Bem-vindo ao Simulador!</h3>
                    <p class="text-gray-700 mb-6" id="scenarioDescription">
                        Escolha um cen√°rio na coluna da direita para come√ßar a praticar estrat√©gias de engagement. 
                        Cada cen√°rio apresenta uma situa√ß√£o real que pode encontrar em projetos de Data Governance.
                    </p>

                    <div id="choicesContainer" class="space-y-3 hidden">
                        <!-- Choices will be populated by JavaScript -->
                    </div>

                    <div id="feedbackContainer" class="mt-6 hidden">
                        <!-- Feedback will be shown here -->
                    </div>

                    <div class="flex space-x-3 mt-6">
                        <button id="nextScenarioBtn" class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors hidden">
                            Pr√≥ximo Cen√°rio
                        </button>
                        <button id="restartBtn" class="bg-gray-600 text-white px-6 py-2 rounded-lg hover:bg-gray-700 transition-colors" onclick="reiniciarSimulador()">
                            üîÑ Reiniciar
                        </button>
                        <button id="exportBtn" class="bg-purple-600 text-white px-6 py-2 rounded-lg hover:bg-purple-700 transition-colors" onclick="exportarRelatorio()">
                            üìä Exportar Relat√≥rio
                        </button>
                    </div>
                </div>
            </div>

            <!-- Coluna Direita: Lista de Cen√°rios -->
            <div class="space-y-6">
                <div class="card p-6">
                    <h3 class="text-lg font-semibold mb-4">üéØ Cen√°rios Dispon√≠veis</h3>
                    <div id="scenariosList" class="space-y-3">
                        <!-- Scenarios will be populated by JavaScript -->
                    </div>
                </div>

                <div class="card p-6">
                    <h3 class="text-lg font-semibold mb-4">üí° Dicas de Engagement</h3>
                    <div class="space-y-3 text-sm text-gray-600">
                        <div class="flex items-start">
                            <span class="text-green-600 mr-2">‚úì</span>
                            <span>Ou√ßa ativamente as preocupa√ß√µes dos stakeholders</span>
                        </div>
                        <div class="flex items-start">
                            <span class="text-green-600 mr-2">‚úì</span>
                            <span>Demonstre valor concreto rapidamente</span>
                        </div>
                        <div class="flex items-start">
                            <span class="text-green-600 mr-2">‚úì</span>
                            <span>Adapte a comunica√ß√£o ao p√∫blico-alvo</span>
                        </div>
                        <div class="flex items-start">
                            <span class="text-green-600 mr-2">‚úì</span>
                            <span>Seja transparente sobre desafios</span>
                        </div>
                        <div class="flex items-start">
                            <span class="text-green-600 mr-2">‚úì</span>
                            <span>Envolva resistentes como consultores</span>
                        </div>
                    </div>
                </div>

                <div class="card p-6">
                    <h3 class="text-lg font-semibold mb-4">üèÜ N√≠veis de Expertise</h3>
                    <div class="space-y-2 text-sm">
                        <div class="flex justify-between">
                            <span>Iniciante</span>
                            <span class="text-gray-500">0-30 pts</span>
                        </div>
                        <div class="flex justify-between">
                            <span>Interm√©dio</span>
                            <span class="text-gray-500">31-60 pts</span>
                        </div>
                        <div class="flex justify-between">
                            <span>Avan√ßado</span>
                            <span class="text-gray-500">61-90 pts</span>
                        </div>
                        <div class="flex justify-between">
                            <span>Especialista</span>
                            <span class="text-gray-500">91+ pts</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentScenario = null;
        let completedScenarios = [];
        let totalScore = 0;
        let currentStreak = 0;
        let userChoices = [];

        const scenarios = [
            {
                id: 1,
                type: "Resist√™ncia Executiva",
                title: "CEO C√©tico com ROI",
                difficulty: "Alto",
                description: "O CEO questiona: 'J√° gastamos milh√µes em TI. Como √© que esta 'governan√ßa de dados' vai realmente aumentar as nossas vendas?' Tem 15 minutos para convenc√™-lo.",
                choices: [
                    {
                        text: "Apresentar casos de uso de concorrentes com ROI comprovado",
                        score: 10,
                        feedback: "Excelente! Dados concretos da ind√∫stria s√£o muito persuasivos para CEOs.",
                        type: "correct"
                    },
                    {
                        text: "Explicar detalhadamente a arquitetura t√©cnica da solu√ß√£o",
                        score: 2,
                        feedback: "CEOs focam em resultados de neg√≥cio, n√£o em detalhes t√©cnicos.",
                        type: "incorrect"
                    },
                    {
                        text: "Mostrar quick wins imediatos (30-60 dias) com m√©tricas claras",
                        score: 8,
                        feedback: "Boa estrat√©gia! Quick wins demonstram valor rapidamente.",
                        type: "partial"
                    },
                    {
                        text: "Argumentar que √© obrigat√≥rio por compliance regulat√≥rio",
                        score: 5,
                        feedback: "Compliance √© importante, mas CEOs preferem oportunidades a obriga√ß√µes.",
                        type: "partial"
                    }
                ]
            },
            {
                id: 2,
                type: "Conflito Departamental",
                title: "Guerra entre IT e Neg√≥cio",
                difficulty: "M√©dio",
                description: "IT diz: 'Os dados est√£o limpos!' Marketing responde: 'Ent√£o porque √© que 30% dos emails retornam?' Como mediar este conflito construtivamente?",
                choices: [
                    {
                        text: "Organizar workshop conjunto para mapear fluxos de dados",
                        score: 10,
                        feedback: "Perfeito! Colabora√ß√£o visual ajuda ambos os lados a entender o problema.",
                        type: "correct"
                    },
                    {
                        text: "Dar raz√£o ao Marketing - os dados claramente t√™m problemas",
                        score: 3,
                        feedback: "Tomar partido piora o conflito. Foque na solu√ß√£o, n√£o na culpa.",
                        type: "incorrect"
                    },
                    {
                        text: "Propor auditoria externa neutra aos dados",
                        score: 7,
                        feedback: "Boa ideia, mas pode ser vista como desconfian√ßa. Tente colabora√ß√£o primeiro.",
                        type: "partial"
                    },
                    {
                        text: "Implementar m√©tricas conjuntas de qualidade de dados",
                        score: 9,
                        feedback: "Excelente! M√©tricas partilhadas alinham objetivos.",
                        type: "correct"
                    }
                ]
            },
            {
                id: 3,
                type: "Resist√™ncia Cultural",
                title: "Equipa Tradicional Resistente",
                difficulty: "Alto",
                description: "Gestor s√©nior com 25 anos na empresa: 'Sempre funcionou assim. Porque mudar agora? Esta 'governan√ßa' √© s√≥ mais burocracia!'",
                choices: [
                    {
                        text: "Respeitar a experi√™ncia e pedir conselhos sobre implementa√ß√£o gradual",
                        score: 10,
                        feedback: "Brilliant! Transformar resist√™ncia em consultoria √© uma t√©cnica avan√ßada.",
                        type: "correct"
                    },
                    {
                        text: "Explicar que os tempos mudaram e √© preciso adaptar-se",
                        score: 4,
                        feedback: "Muito direto. Pessoas experientes precisam sentir-se valorizadas, n√£o criticadas.",
                        type: "incorrect"
                    },
                    {
                        text: "Mostrar exemplos de problemas causados pela falta de governan√ßa",
                        score: 7,
                        feedback: "√ötil, mas pode soar como cr√≠tica. Combine com reconhecimento da experi√™ncia.",
                        type: "partial"
                    },
                    {
                        text: "Sugerir que lidere um piloto na sua √°rea de expertise",
                        score: 9,
                        feedback: "Excelente! Dar ownership transforma resistentes em champions.",
                        type: "correct"
                    }
                ]
            },
            {
                id: 4,
                type: "Press√£o de Prazos",
                title: "Projeto Urgente vs. Governan√ßa",
                difficulty: "Alto",
                description: "Diretor de projeto: 'Precisamos entregar este dashboard em 2 semanas para o conselho. N√£o temos tempo para 'governan√ßa'. Usamos os dados que temos!'",
                choices: [
                    {
                        text: "Oferecer suporte r√°pido para validar dados cr√≠ticos apenas",
                        score: 10,
                        feedback: "Perfeito! Flexibilidade com foco no essencial demonstra valor imediato.",
                        type: "correct"
                    },
                    {
                        text: "Insistir que sem governan√ßa o projeto vai falhar",
                        score: 3,
                        feedback: "Muito r√≠gido. Em situa√ß√µes urgentes, seja pragm√°tico mas √∫til.",
                        type: "incorrect"
                    },
                    {
                        text: "Propor governan√ßa retrospetiva ap√≥s a entrega",
                        score: 6,
                        feedback: "Comprometedor, mas 'governan√ßa retrospetiva' raramente acontece na pr√°tica.",
                        type: "partial"
                    },
                    {
                        text: "Criar checklist r√°pido de qualidade para dados do dashboard",
                        score: 8,
                        feedback: "Boa solu√ß√£o pr√°tica! Checklist √© governan√ßa light mas eficaz.",
                        type: "partial"
                    }
                ]
            },
            {
                id: 5,
                type: "Quest√µes de Recursos",
                title: "Or√ßamento Limitado",
                difficulty: "M√©dio",
                description: "CFO: 'Entendo a import√¢ncia, mas n√£o temos budget. Podem fazer governan√ßa com recursos atuais?' Como responder construtivamente?",
                choices: [
                    {
                        text: "Propor abordagem faseada come√ßando com policies b√°sicas",
                        score: 10,
                        feedback: "Excelente! Mostrar que DG pode come√ßar pequeno mas estruturado.",
                        type: "correct"
                    },
                    {
                        text: "Explicar que governan√ßa s√©ria requer investimento adequado",
                        score: 5,
                        feedback: "Verdade, mas n√£o ajuda a resolver o problema do CFO.",
                        type: "partial"
                    },
                    {
                        text: "Sugerir usar viola√ß√µes de dados como business case para budget",
                        score: 4,
                        feedback: "Usar 'fear mongering' pode funcionar, mas n√£o constr√≥i partnership genu√≠no.",
                        type: "incorrect"
                    },
                    {
                        text: "Calcular custo de m√° qualidade de dados vs. investimento DG",
                        score: 9,
                        feedback: "Muito bom! CFOs respondem bem a an√°lises custo-benef√≠cio claras.",
                        type: "correct"
                    }
                ]
            },
            {
                id: 6,
                type: "Complexidade T√©cnica",
                title: "Arquiteto C√©tico",
                difficulty: "M√©dio",
                description: "Arquiteto chefe: 'A nossa infraestrutura √© muito complexa. Esta governan√ßa vai quebrar tudo. J√° temos problemas de performance...'",
                choices: [
                    {
                        text: "Propor implementa√ß√£o por camadas, come√ßando com metadata",
                        score: 9,
                        feedback: "Excelente abordagem t√©cnica! Metadata √© menos invasivo mas muito valioso.",
                        type: "correct"
                    },
                    {
                        text: "Garantir que governan√ßa n√£o afeta performance dos sistemas",
                        score: 6,
                        feedback: "Garantias vazias n√£o tranquilizam arquitetos. Seja mais espec√≠fico.",
                        type: "partial"
                    },
                    {
                        text: "Sugerir auditoria de arquitetura antes de implementar DG",
                        score: 8,
                        feedback: "Boa! Arquitetos apreciam avalia√ß√£o t√©cnica cuidadosa.",
                        type: "partial"
                    },
                    {
                        text: "Envolv√™-lo no design da solu√ß√£o de governan√ßa",
                        score: 10,
                        feedback: "Perfeito! Ownership t√©cnico elimina resist√™ncia e melhora a solu√ß√£o.",
                        type: "correct"
                    }
                ]
            },
            {
                id: 7,
                type: "Stakeholder Neutro",
                title: "Gestor Indiferente",
                difficulty: "Baixo",
                description: "Gestor de vendas: 'Tanto me faz. Se n√£o afetar as minhas equipas nem os n√∫meros, fa√ßam o que quiserem.' Como engajar?",
                choices: [
                    {
                        text: "Mostrar como DG pode melhorar insights de vendas",
                        score: 10,
                        feedback: "Perfeito! Conectar DG aos KPIs dele gera interesse genu√≠no.",
                        type: "correct"
                    },
                    {
                        text: "Aceitar a neutralidade e seguir em frente",
                        score: 5,
                        feedback: "Neutralidade pode virar resist√™ncia mais tarde. Melhor engajar agora.",
                        type: "partial"
                    },
                    {
                        text: "Explicar que governan√ßa eventualmente afetar√° todos",
                        score: 4,
                        feedback: "Soa amea√ßador. Foque em benef√≠cios, n√£o em 'eventuais impactos'.",
                        type: "incorrect"
                    },
                    {
                        text: "Pedir para ser advisor do projeto na perspetiva de vendas",
                        score: 8,
                        feedback: "Boa estrat√©gia! Dar papel consultivo transforma indiferen√ßa em interesse.",
                        type: "partial"
                    }
                ]
            },
            {
                id: 8,
                type: "Conflito de Prioridades",
                title: "M√∫ltiplos Projetos Concorrentes",
                difficulty: "Alto",
                description: "VP Tecnologia: 'Temos migra√ß√£o cloud, implementa√ß√£o CRM e upgrade ERP. Governan√ßa fica para 2025.' Como priorizar DG?",
                choices: [
                    {
                        text: "Demonstrar como DG suporta e melhora todos esses projetos",
                        score: 10,
                        feedback: "Brilliant! Posicionar DG como enabler, n√£o como competitor.",
                        type: "correct"
                    },
                    {
                        text: "Argumentar que DG deve ser prioridade m√°xima",
                        score: 3,
                        feedback: "Competir por prioridade raramente funciona. Busque sinergia.",
                        type: "incorrect"
                    },
                    {
                        text: "Sugerir governan√ßa m√≠nima integrada nos projetos existentes",
                        score: 8,
                        feedback: "Pragm√°tico! DG embutido em projetos √© menos resist√™ncia.",
                        type: "partial"
                    },
                    {
                        text: "Propor que cada projeto tenha componente de governan√ßa",
                        score: 9,
                        feedback: "Excelente! Cada projeto se torna um piloto de DG.",
                        type: "correct"
                    }
                ]
            },
            {
                id: 9,
                type: "Quest√µes Legais",
                title: "Advogado Preocupado",
                difficulty: "M√©dio",
                description: "Jur√≠dico: 'Centralizar governan√ßa de dados aumenta nossa responsabilidade legal. E se algo correr mal? Preferimos descentralizado...'",
                choices: [
                    {
                        text: "Explicar que governan√ßa reduz riscos legais via controlos",
                        score: 8,
                        feedback: "Correto! Mas jur√≠dicos precisam de exemplos concretos de prote√ß√£o legal.",
                        type: "partial"
                    },
                    {
                        text: "Propor framework que distribui responsabilidades claramente",
                        score: 10,
                        feedback: "Perfeito! Clareza de responsabilidades √© o que jur√≠dicos mais valorizam.",
                        type: "correct"
                    },
                    {
                        text: "Garantir que jur√≠dico aprova todas as policies de dados",
                        score: 7,
                        feedback: "Bom envolvimento, mas pode tornar processo muito lento.",
                        type: "partial"
                    },
                    {
                        text: "Mostrar como outras empresas geriram riscos legais em DG",
                        score: 9,
                        feedback: "Excelente! Jur√≠dicos confiam em precedentes e benchmarks.",
                        type: "correct"
                    }
                ]
            },
            {
                id: 10,
                type: "Quest√µes de Compet√™ncias",
                title: "Equipa Sem Forma√ß√£o",
                difficulty: "M√©dio",
                description: "Gestor de RH: 'A nossa equipa n√£o tem compet√™ncias para esta 'governan√ßa'. Seria preciso forma√ß√£o massiva que n√£o temos budget...'",
                choices: [
                    {
                        text: "Propor upskilling gradual da equipa interna",
                        score: 8,
                        feedback: "Boa abordagem! Desenvolvimento interno gera ownership.",
                        type: "partial"
                    },
                    {
                        text: "Sugerir come√ßar com consultores e transfer knowledge",
                        score: 7,
                        feedback: "Pragm√°tico, mas garanta que h√° transfer real de conhecimento.",
                        type: "partial"
                    },
                    {
                        text: "Criar programa de 'champions' internos com forma√ß√£o focada",
                        score: 10,
                        feedback: "Excelente! Champions distribuem conhecimento e reduzem custos.",
                        type: "correct"
                    },
                    {
                        text: "Argumentar que √© investimento essencial no futuro",
                        score: 5,
                        feedback: "Verdade, mas n√£o resolve o problema imediato de budget do RH.",
                        type: "partial"
                    }
                ]
            },
            {
                id: 11,
                type: "Press√£o Regulat√≥ria",
                title: "Auditoria Surpresa",
                difficulty: "Alto",
                description: "Compliance: 'Temos auditoria externa na pr√≥xima semana. Descobriram gaps enormes de dados. Podem resolver isto em 5 dias?'",
                choices: [
                    {
                        text: "Criar documenta√ß√£o r√°pida do estado atual dos dados",
                        score: 9,
                        feedback: "Excelente resposta de crise! Transpar√™ncia ajuda com auditores.",
                        type: "correct"
                    },
                    {
                        text: "Explicar que governan√ßa adequada leva meses",
                        score: 4,
                        feedback: "Tecnicamente correto, mas n√£o ajuda na crise atual.",
                        type: "incorrect"
                    },
                    {
                        text: "Focar nos dados cr√≠ticos para a auditoria apenas",
                        score: 10,
                        feedback: "Perfect! Triage inteligente em situa√ß√£o de crise.",
                        type: "correct"
                    },
                    {
                        text: "Sugerir contratar consultores especialistas em compliance",
                        score: 7,
                        feedback: "Pode ajudar, mas em 5 dias √© dif√≠cil conseguir e integrar consultores.",
                        type: "partial"
                    }
                ]
            },
            {
                id: 12,
                type: "Sucesso Inicial",
                title: "Expans√£o Prematura",
                difficulty: "M√©dio",
                description: "Sponsor entusiasmado: 'O piloto correu muito bem! Vamos implementar em toda a empresa no pr√≥ximo m√™s!' Como gerir expectativas?",
                choices: [
                    {
                        text: "Celebrar sucesso mas propor expans√£o faseada e estruturada",
                        score: 10,
                        feedback: "Perfeito! Balan√ßa entusiasmo com realismo operacional.",
                        type: "correct"
                    },
                    {
                        text: "Concordar totalmente e acelerar implementa√ß√£o",
                        score: 4,
                        feedback: "Perigoso! Expans√£o muito r√°pida pode comprometer qualidade.",
                        type: "incorrect"
                    },
                    {
                        text: "Explicar todos os riscos de expans√£o r√°pida",
                        score: 6,
                        feedback: "Importante, mas pode desmotivar o sponsor. Balance riscos com oportunidades.",
                        type: "partial"
                    },
                    {
                        text: "Propor roadmap com marcos claros e m√©tricas de sucesso",
                        score: 9,
                        feedback: "Excelente! Estrutura mant√©m momentum mas garante qualidade.",
                        type: "correct"
                    }
                ]
            }
        ];

        function initializeSimulator() {
            renderScenariosList();
            updateDashboard();
        }

        function renderScenariosList() {
            const container = document.getElementById('scenariosList');
            container.innerHTML = '';

            scenarios.forEach(scenario => {
                const isCompleted = completedScenarios.includes(scenario.id);
                const card = document.createElement('div');
                card.className = `scenario-card p-3 border rounded-lg ${isCompleted ? 'bg-green-50 border-green-200' : 'bg-white border-gray-200'}`;
                card.onclick = () => loadScenario(scenario);

                card.innerHTML = `
                    <div class="flex items-center justify-between">
                        <div>
                            <div class="font-medium text-sm">${scenario.title}</div>
                            <div class="text-xs text-gray-500">${scenario.type}</div>
                        </div>
                        <div class="flex items-center space-x-2">
                            <span class="text-xs px-2 py-1 rounded ${getDifficultyColor(scenario.difficulty)}">${scenario.difficulty}</span>
                            ${isCompleted ? '<span class="text-green-600">‚úì</span>' : ''}
                        </div>
                    </div>
                `;

                container.appendChild(card);
            });
        }

        function getDifficultyColor(difficulty) {
            switch(difficulty) {
                case 'Baixo': return 'bg-green-100 text-green-800';
                case 'M√©dio': return 'bg-yellow-100 text-yellow-800';
                case 'Alto': return 'bg-red-100 text-red-800';
                default: return 'bg-gray-100 text-gray-800';
            }
        }

        function loadScenario(scenario) {
            currentScenario = scenario;
            
            document.getElementById('scenarioType').textContent = scenario.type;
            document.getElementById('scenarioDifficulty').textContent = `Dificuldade: ${scenario.difficulty}`;
            document.getElementById('scenarioTitle').textContent = scenario.title;
            document.getElementById('scenarioDescription').textContent = scenario.description;
            
            renderChoices(scenario.choices);
            
            document.getElementById('choicesContainer').classList.remove('hidden');
            document.getElementById('feedbackContainer').classList.add('hidden');
            document.getElementById('nextScenarioBtn').classList.add('hidden');
        }

        function renderChoices(choices) {
            const container = document.getElementById('choicesContainer');
            container.innerHTML = '';

            choices.forEach((choice, index) => {
                const button = document.createElement('button');
                button.className = 'choice-btn w-full p-4 text-left border border-gray-300 rounded-lg hover:border-blue-500 transition-all';
                button.textContent = choice.text;
                button.onclick = () => selectChoice(choice, index);
                container.appendChild(button);
            });
        }

        function selectChoice(choice, choiceIndex) {
            // Disable all buttons
            const buttons = document.querySelectorAll('.choice-btn');
            buttons.forEach(btn => btn.disabled = true);

            // Highlight selected choice
            buttons[choiceIndex].classList.add(choice.type);

            // Update score and streak
            totalScore += choice.score;
            if (choice.score >= 8) {
                currentStreak++;
            } else {
                currentStreak = 0;
            }

            // Record choice
            userChoices.push({
                scenarioId: currentScenario.id,
                scenarioTitle: currentScenario.title,
                choice: choice.text,
                score: choice.score,
                feedback: choice.feedback
            });

            // Mark scenario as completed
            if (!completedScenarios.includes(currentScenario.id)) {
                completedScenarios.push(currentScenario.id);
            }

            // Show feedback
            showFeedback(choice);
            
            // Update dashboard
            updateDashboard();
            renderScenariosList();
            
            // Show next button
            document.getElementById('nextScenarioBtn').classList.remove('hidden');
        }

        function showFeedback(choice) {
            const container = document.getElementById('feedbackContainer');
            container.innerHTML = `
                <div class="p-4 border rounded-lg ${choice.type === 'correct' ? 'border-green-300 bg-green-50' : choice.type === 'partial' ? 'border-yellow-300 bg-yellow-50' : 'border-red-300 bg-red-50'}">
                    <div class="flex items-center mb-2">
                        <span class="text-lg mr-2">${choice.type === 'correct' ? 'üéâ' : choice.type === 'partial' ? '‚ö°' : 'üí°'}</span>
                        <span class="font-semibold">Pontua√ß√£o: ${choice.score}/10</span>
                    </div>
                    <p>${choice.feedback}</p>
                </div>
            `;
            container.classList.remove('hidden');
        }

        function updateDashboard() {
            document.getElementById('scenarioCounter').textContent = `${completedScenarios.length}/${scenarios.length}`;
            document.getElementById('scoreDisplay').textContent = totalScore;
            document.getElementById('streakDisplay').textContent = currentStreak;
            
            // Update level
            let level = 'Iniciante';
            if (totalScore > 90) level = 'Especialista';
            else if (totalScore > 60) level = 'Avan√ßado';
            else if (totalScore > 30) level = 'Interm√©dio';
            document.getElementById('levelDisplay').textContent = level;
            
            // Update progress
            const progress = (completedScenarios.length / scenarios.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('progressText').textContent = Math.round(progress) + '%';
        }

        function getNextScenario() {
            const remaining = scenarios.filter(s => !completedScenarios.includes(s.id));
            if (remaining.length > 0) {
                return remaining[Math.floor(Math.random() * remaining.length)];
            }
            return null;
        }

        function reiniciarSimulador() {
            if (confirm('Tem a certeza que deseja reiniciar o simulador? Todo o progresso ser√° perdido.')) {
                currentScenario = null;
                completedScenarios = [];
                totalScore = 0;
                currentStreak = 0;
                userChoices = [];
                
                // Reset UI
                document.getElementById('scenarioTitle').textContent = 'Bem-vindo ao Simulador!';
                document.getElementById('scenarioDescription').textContent = 'Escolha um cen√°rio na coluna da direita para come√ßar a praticar estrat√©gias de engagement.';
                document.getElementById('choicesContainer').classList.add('hidden');
                document.getElementById('feedbackContainer').classList.add('hidden');
                document.getElementById('nextScenarioBtn').classList.add('hidden');
                
                updateDashboard();
                renderScenariosList();
            }
        }

        function exportarRelatorio() {
            const BOM = '\ufeff';
            let csv = BOM + 'Cen√°rio;Escolha;Pontua√ß√£o;Feedback\n';
            
            userChoices.forEach(choice => {
                csv += `"${choice.scenarioTitle}";"${choice.choice}";${choice.score};"${choice.feedback}"\n`;
            });
            
            csv += `\nResumo Final:\n`;
            csv += `Cen√°rios Completados;${completedScenarios.length}/${scenarios.length}\n`;
            csv += `Pontua√ß√£o Total;${totalScore}\n`;
            csv += `N√≠vel Final;${document.getElementById('levelDisplay').textContent}\n`;
            
            const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = 'relatorio-engagement-simulator.csv';
            link.click();
        }

        // Event listeners
        document.getElementById('nextScenarioBtn').addEventListener('click', () => {
            const next = getNextScenario();
            if (next) {
                loadScenario(next);
            } else {
                alert('Parab√©ns! Completou todos os cen√°rios dispon√≠veis! üéâ');
            }
        });

        // Initialize on page load
        initializeSimulator();
    </script>
</body>
</html>
