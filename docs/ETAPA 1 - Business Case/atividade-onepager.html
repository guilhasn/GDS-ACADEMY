<!doctype html>
<html lang="pt">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Atividade — One-Pager do Business Case (Banco)</title>
  <!-- Tailwind via CDN (para layout rápido) -->
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .kbd{border:1px solid #ddd;border-bottom-width:2px;border-right-width:2px;border-radius:.4rem;padding:.15rem .35rem;font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace;font-size:.85rem;background:#f8fafc}
    .hint{font-size:.9rem;color:#475569}
    .card{background:#ffffff;border:1px solid #e5e7eb;border-radius:1rem;box-shadow:0 4px 18px rgba(2,6,23,.06)}
    .req::after{content:" *"; color:#dc2626; font-weight:700}
    textarea{resize:vertical}
    .mono{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace}
  </style>
</head>
<body class="bg-slate-50 text-slate-800">
  <header class="bg-indigo-700 text-white">
    <div class="max-w-7xl mx-auto px-4 py-4 flex items-center justify-between">
      <h1 class="text-xl md:text-2xl font-semibold">Atividade — One-Pager do Business Case</h1>
      <div class="text-sm opacity-90">Cenário: Banco | Programa de Governança de Dados</div>
    </div>
  </header>

  <main class="max-w-7xl mx-auto px-4 py-6 grid grid-cols-1 lg:grid-cols-2 gap-6">
    <!-- FORMULÁRIO -->
    <section class="card p-5">
      <h2 class="text-lg font-semibold mb-3">Preenchimento (lado esquerdo)</h2>
      <p class="hint mb-4">
        Objetivo: gerar um <em>one-pager</em> que legitime o Programa de Governança de Dados num banco (à luz de Ladley). 
        Preencha os campos e use <span class="kbd">Exportar</span> para obter Markdown/JSON ou <span class="kbd">Imprimir/PDF</span>.
      </p>

      <form id="form" class="space-y-4">
        <div>
          <label class="block font-medium req">Objetivo do programa</label>
          <textarea id="objetivo" rows="3" class="mt-1 w-full rounded-lg border-slate-300" placeholder="Ex.: Estabelecer capacidades de governança (papéis, políticas e métricas) para reduzir riscos e aumentar o valor dos dados em 12 meses."></textarea>
          <p class="hint mt-1">Alinhar com a estratégia do banco e metas mensuráveis.</p>
        </div>

        <div>
          <label class="block font-medium req">Sponsor executivo</label>
          <input id="sponsor" type="text" class="mt-1 w-full rounded-lg border-slate-300" placeholder="Ex.: CFO, COO, CRO, CDO Executivo"/>
          <p class="hint mt-1">Idealmente alguém com influência transversal (C-level) e mandato claro.</p>
        </div>

        <!-- Benefícios -->
        <div>
          <label class="block font-medium req">4 Benefícios principais</label>
          <div id="beneficios" class="space-y-2 mt-2"></div>
          <p class="hint mt-1">Ex.: redução de retrabalho; melhoria da qualidade; aceleração de análise; conformidade RGPD/BCBS.</p>
        </div>

        <!-- Riscos -->
        <div>
          <label class="block font-medium req">4 Riscos a mitigar</label>
          <div id="riscos" class="space-y-2 mt-2"></div>
          <p class="hint mt-1">Ex.: dados mestres inconsistentes; acessos excessivos; falhas de linhagem; sanções regulatórias.</p>
        </div>

        <!-- KPIs -->
        <div>
          <label class="block font-medium req">4 Métricas de sucesso (KPIs)</label>
          <div id="kpis" class="space-y-2 mt-2"></div>
          <p class="hint mt-1">Ex.: % domínios com steward; nº incidentes de qualidade; tempo de ciclo de pedidos; % dados classificados.</p>
        </div>

        <div class="flex flex-wrap gap-2 pt-2">
          <button type="button" id="btn-exemplo" class="rounded-lg bg-slate-200 hover:bg-slate-300 px-3 py-2">Preencher exemplo</button>
          <button type="button" id="btn-limpar" class="rounded-lg bg-white border px-3 py-2">Limpar</button>
          <button type="button" id="btn-guardar" class="rounded-lg bg-indigo-600 text-white px-3 py-2 hover:bg-indigo-700">Guardar (browser)</button>
          <button type="button" id="btn-md" class="rounded-lg bg-emerald-600 text-white px-3 py-2 hover:bg-emerald-700">Exportar Markdown</button>
          <button type="button" id="btn-json" class="rounded-lg bg-teal-600 text-white px-3 py-2 hover:bg-teal-700">Exportar JSON</button>
          <button type="button" id="btn-copiar" class="rounded-lg bg-yellow-500 text-white px-3 py-2 hover:bg-yellow-600">Copiar Markdown</button>
          <button type="button" id="btn-print" class="rounded-lg bg-slate-800 text-white px-3 py-2">Imprimir / PDF</button>
        </div>
        <p class="hint pt-1">Dados guardados no <strong>localStorage</strong> do navegador (apenas neste dispositivo). Não há envio para servidor.</p>
      </form>

      <hr class="my-5"/>

      <details class="mt-2">
        <summary class="cursor-pointer font-medium">Guião (Ladley) & Enquadramento (ISO/RGPD)</summary>
        <ul class="list-disc pl-6 mt-2 text-sm leading-6">
          <li><strong>Ladley — Business Case</strong>: visão, riscos de não agir, custos da má qualidade, oportunidades, <em>data debt</em>, obstáculos/impactos/mudanças, processo de validação com stakeholders.</li>
          <li><strong>ISO/IEC 27001</strong>: alinhar com objetivos de segurança; incluir controlos relevantes (acessos, classificação, retenção, logging).</li>
          <li><strong>RGPD</strong>: privacy-by-design, minimização, bases legais; avaliar se é necessária AIPD (DPIA) em certos casos.</li>
        </ul>
      </details>
    </section>

    <!-- PRÉ-VISUALIZAÇÃO -->
    <section class="card p-5">
      <h2 class="text-lg font-semibold mb-3">Pré-visualização (lado direito)</h2>

      <div class="grid grid-cols-1 gap-3">
        <div>
          <label class="block text-sm font-medium mb-1">Markdown gerado</label>
          <textarea id="md" rows="18" class="w-full rounded-lg border-slate-300 mono"></textarea>
        </div>
        <div>
          <label class="block text-sm font-medium mb-1">Renderização rápida</label>
          <article id="render" class="prose max-w-none"></article>
        </div>
      </div>
    </section>
  </main>

  <footer class="text-center text-sm text-slate-500 py-6">
    © GSD Academy — atividade “One-Pager do Business Case (Banco)”. Guardado localmente; exporte para Markdown/JSON ou PDF.
  </footer>

  <script>
    // ---------- util ----------
    const $ = (sel) => document.querySelector(sel);
    const createInput = (name, placeholder) => {
      const input = document.createElement('input');
      input.type = 'text';
      input.placeholder = placeholder;
      input.className = 'w-full rounded-lg border-slate-300';
      input.dataset.name = name;
      return input;
    };
    const createList = (id, label, count, placeholders) => {
      const wrap = document.getElementById(id);
      wrap.innerHTML = '';
      for (let i=0;i<count;i++){
        const div = document.createElement('div');
        div.appendChild(createInput(id, placeholders[i] || `${label} ${i+1}`));
        wrap.appendChild(div);
      }
    };
    const getValues = (id) => [...document.querySelectorAll('#'+id+' input')].map(i => i.value.trim()).filter(Boolean);
    const setValues = (id, arr=[]) => {
      const inputs = document.querySelectorAll('#'+id+' input');
      inputs.forEach((i,idx)=> i.value = arr[idx] ?? '');
    };
    const dl = (filename, text, mime='text/plain') => {
      const blob = new Blob([text], {type: mime});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url; a.download = filename; a.click();
      URL.revokeObjectURL(url);
    };

    // ---------- inicializar listas ----------
    createList('beneficios','Benefício',4,[
      'Ex.: -20% retrabalho em 9 meses',
      'Ex.: +15% qualidade em dados de cliente',
      'Ex.: Acelerar time-to-insight em 25%',
      'Ex.: Reduzir não conformidades RGPD'
    ]);
    createList('riscos','Risco',4,[
      'Ex.: Multas/penalizações (RGPD/BCBS)',
      'Ex.: Acessos excessivos a dados sensíveis',
      'Ex.: Inconsistência de dados mestres',
      'Ex.: Falhas na linhagem/tracing'
    ]);
    createList('kpis','KPI',4,[
      'Ex.: % domínios com steward nomeado',
      'Ex.: Nº incidentes de qualidade/mês',
      'Ex.: Tempo ciclo de pedidos de dados',
      'Ex.: % dados classificados por nível'
    ]);

    // ---------- estado ----------
    const KEY = 'gsd_onepager_banco_v1';
    function readForm(){
      return {
        objetivo: $('#objetivo').value.trim(),
        sponsor:  $('#sponsor').value.trim(),
        beneficios: getValues('beneficios'),
        riscos:     getValues('riscos'),
        kpis:       getValues('kpis')
      }
    }
    function writeForm(d){
      $('#objetivo').value = d.objetivo || '';
      $('#sponsor').value = d.sponsor || '';
      setValues('beneficios', d.beneficios || []);
      setValues('riscos', d.riscos || []);
      setValues('kpis', d.kpis || []);
      render();
    }

    // ---------- render Markdown + preview ----------
    function toMarkdown(d){
      const list = (arr, prefix='- ') => (arr||[]).map(v => `${prefix}${v}`).join('\n');
      return `# One-Pager — Business Case (Banco)

**Objetivo do Programa**  
${d.objetivo || ''}

**Sponsor Executivo**  
${d.sponsor || ''}

**Benefícios (4)**  
${list(d.beneficios)}

**Riscos a Mitigar (4)**  
${list(d.riscos)}

**Métricas de Sucesso — KPIs (4)**  
${list(d.kpis)}

---

**Notas**  
- Este one-pager segue as linhas de John Ladley (Business Case): visão, riscos, custos da má qualidade, oportunidades, *data debt*, obstáculos/impactos/mudanças.  
- Enquadramento: ISO/IEC 27001 (controlos de segurança), ISO 27005 (risco), RGPD (privacy-by-design).`;
    }
    function markdownToHtml(md){
      // conversor mínimo (sem libs externas) só para headers e listas
      let html = md
        .replace(/^# (.*$)/gim, '<h1>$1</h1>')
        .replace(/^\*\*(.*?)\*\*/gim, '<strong>$1</strong>')
        .replace(/\*\*(.*?)\*\*/gim, '<strong>$1</strong>')
        .replace(/^(?:- |\u2022 )(.*)$/gim, '<li>$1</li>');
      html = html.replace(/(<li>.*<\/li>)/gims, '<ul>$1</ul>');
      html = html.replace(/\n{2,}/g, '<br/><br/>');
      return html;
    }
    function render(){
      const d = readForm();
      const md = toMarkdown(d);
      $('#md').value = md;
      $('#render').innerHTML = markdownToHtml(md);
    }
    ['objetivo','sponsor'].forEach(id => $('#'+id).addEventListener('input', render));
    ['beneficios','riscos','kpis'].forEach(id => {
      document.querySelector('#'+id).addEventListener('input', render);
    });

    // ---------- ações ----------
    $('#btn-exemplo').addEventListener('click', ()=>{
      writeForm({
        objetivo: 'Estabelecer governança de dados corporativa para aumentar a qualidade e confiança dos dados críticos, reduzir risco regulatório e acelerar decisões.',
        sponsor: 'CRO + CDO Executivo',
        beneficios: [
          'Redução de 25% no retrabalho analítico em 12 meses',
          'Conformidade reforçada (RGPD/BCBS) e evidência de controlos',
          'Qualidade em dados de cliente (+20% nas regras críticas)',
          'Time-to-insight reduzido em 30% em relatórios de gestão'
        ],
        riscos: [
          'Multas por incumprimento RGPD/BCBS e danos reputacionais',
          'Acessos excessivos a dados sensíveis e ausência de logs',
          'Dados mestres inconsistentes entre sistemas core',
          'Falta de linhagem impacta auditorias e confiança'
        ],
        kpis: [
          '% domínios com steward nomeado (meta: ≥80% em 6m)',
          'Nº incidentes de qualidade/mês (meta: -40% em 9m)',
          'Tempo de ciclo de pedidos de dados (meta: -30%)',
          '% registos classificados e com retenção definida (meta: ≥90%)'
        ]
      });
    });

    $('#btn-limpar').addEventListener('click', ()=>{
      writeForm({objetivo:'', sponsor:'', beneficios:['','','',''], riscos:['','','',''], kpis:['','','','']});
      localStorage.removeItem(KEY);
    });

    $('#btn-guardar').addEventListener('click', ()=>{
      localStorage.setItem(KEY, JSON.stringify(readForm()));
      alert('Guardado no navegador (localStorage).');
    });

    $('#btn-md').addEventListener('click', ()=>{
      dl('onepager-business-case.md', $('#md').value, 'text/markdown;charset=utf-8');
    });

    $('#btn-json').addEventListener('click', ()=>{
      dl('onepager-business-case.json', JSON.stringify(readForm(), null, 2), 'application/json;charset=utf-8');
    });

    $('#btn-copiar').addEventListener('click', async ()=>{
      await navigator.clipboard.writeText($('#md').value);
      alert('Markdown copiado para a área de transferência.');
    });

    $('#btn-print').addEventListener('click', ()=>{ window.print(); });

    // ---------- load state ----------
    const saved = localStorage.getItem(KEY);
    if (saved) { try { writeForm(JSON.parse(saved)); } catch(e){ render(); } }
    else { render(); }
  </script>
</body>
</html>
